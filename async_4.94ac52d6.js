(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{166:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c}));var s=r(156);const l=s.a.getComponent("MenuItem");class n extends l{constructor(e,t){const r=t.label;t.label=r,t.selected=r===e.currentResolution().label,t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=r,this.on(e,"resolutionchange",e=>this.update(e))}handleClick(e){super.handleClick(),this.player().currentResolution(this.label)}update(){const e=this.label===this.player().currentResolution().label;this.selected(e)}}n.prototype.contentElType="button",s.a.registerComponent("ResolutionMenuItem",n);const o=s.a.getComponent("MenuButton");class u extends o{constructor(e,t){super(e),this.controlText("Quality"),this.on(e,"loadstart",e=>this.updateLabel(e)),this.on(e,"updateSources",e=>{this.updateLabel(e),this.update()})}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=s.a.dom.createEl("div",{className:"vjs-resolution-button-label",id:this.labelElId_,textContent:""}),e.appendChild(this.labelEl_),e}dispose(){super.dispose()}buildCSSClass(){return"vjs-resolution-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-resolution-button "+super.buildWrapperCSSClass()}createItems(){this.sources=this.player().groupedSrc;const e=[],t=this.sources&&this.sources.label||{};for(let r in t)t.hasOwnProperty(r)&&e.push(new n(this.player(),{label:r,src:t[r],selected:r===(!!this.currentSelection&&this.currentSelection.label)}));return e}updateLabel(){this.currentSelection=this.player().currentResolution(),this.labelEl_.textContent=this.currentSelection?this.currentSelection.label:""}}s.a.registerComponent("ResolutionMenuButton",u);let i;window.videojs?(i=window.videojs,console.warn("SwitcherPlugin:检测到window.videojs")):i=s.a;const a=i.getPlugin("plugin");class c extends a{constructor(e,t={}){function r(e,t){return e.res&&t.res?+t.res-+e.res:0}super(e,t),e.updateSrc=function(s){if(!Array.isArray(s)&&s.length)return e.src();s=s.filter((function(t){try{return""!==e.canPlayType(t.type)}catch(e){return!0}})),this.currentSources=s.sort(r),this.groupedSrc=function(e){let t={label:{},res:{},type:{}};return e.map((function(e){for(let r in t)null==t[r][e[r]]&&(t[r][e[r]]=[]),t[r][e[r]].push(e)})),t}(this.currentSources);let l=function(e,r){let s=t.default||"low",l="";"high"===s?(s=r[0].res,l=r[0].label):"low"!==s&&e.res[s]?e.res[s]&&(l=e.res[s][0].label):(s=r[r.length-1].res,l=r[r.length-1].label);return{res:s,label:l,sources:e.res[s]}}(this.groupedSrc,this.currentSources);return this.currentResolutionState={label:l.label,sources:l.sources},e.trigger("updateSources"),e.setSourcesSanitized(l.sources,l.label),e.trigger("resolutionchange"),e},e.currentResolution=function(t){if(null==t)return this.currentResolutionState;if(!this.groupedSrc||!this.groupedSrc.label||!this.groupedSrc.label[t])return;let r=this.groupedSrc.label[t],s=e.currentTime(),l=e.paused();return!l&&this.player().options_.bigPlayButton&&this.player().bigPlayButton.hide(),e.setSourcesSanitized(r,t).one("loadeddata",(function(){e.currentTime(s),l||e.play(),e.trigger("updateSources"),e.trigger("resolutionchange")})),e},e.setSourcesSanitized=function(t,r){return this.currentResolutionState={label:r,sources:t},e.src(t.map((function(e){return{src:e.src,type:e.type,res:e.res}}))),e};let s=new u(e);e.controlBar.el_.insertBefore(s.el_,e.controlBar.getChild("fullscreenToggle").el_),e.options_.sources.length>1&&e.updateSrc(e.options_.sources)}dispose(){super.dispose()}}c.defaultState={},c.VERSION="0.0.6",i.registerPlugin("SwitcherPlugin",c)}}]);